{
    "contents" : "# Andrew Fairless, August 2011\n# modified May 2015 for posting onto Github\n# This script constructs the bar graph for Figure 3c of Fairless et al 2013\n# Fairless et al 2013, doi: 10.1016/j.bbr.2012.08.051, PMID: 22982070, PMCID: PMC3554266\n\ninstall.packages(\"gplots\", dependencies = TRUE)   # install package if not already installed\n\nlibrary(gplots)\nsource(\"barplot2af2.txt\")                         # contains modified barplot2 function\n\nbargraphtable = read.table(\"bargraphtable.txt\", header = TRUE, sep = \"\\t\")      # table of parameters for bar graph\nbars = t((bargraphtable[ ,5:9] / 61) * 100)       # heights of the bars (group means)\nbarcolors = t(bargraphtable[ ,15:19])\nbtwnbarspace = bargraphtable$btwnspace            # specifies amount of open space to the left of each bar\nplottop = 40\ntkmks = seq(0, plottop, by = 5)                   # tickmarks for left-hand y-axis\ntkmks2 = seq(0, 20, by = 5)                       # tickmarks for right-hand y-axis\nxlabels = rep(c(\"female\", \"female\", \"   male\", \"   male\"), 3)                   # x-axis labels\nbarmidpoints = c(2.1, 3.1, 4.9, 5.9, 8.5, 9.5, 11.3, 12.3, 14.9, 15.9, 17.7, 18.7)   # horizontal positions of bars\nleg1 = c(barcolors[5, 1], barcolors[4, 1], barcolors[3, 1], barcolors[2, 1], barcolors[1, 1], \n         barcolors[5, 2], barcolors[4, 2], barcolors[3, 2], barcolors[2, 2], barcolors[1, 2])  # legend colors\nleg2 = c(\"C57BL/6J active (anogenital)\", \"C57BL/6J active (body)\", \n         \"C57BL/6J passive (pawing)\", \"C57BL/6J passive (moving)\", \n         \"C57BL/6J passive (not moving)\", \"BALB/cJ active (anogenital)\", \n         \"BALB/cJ active (body)\", \"BALB/cJ passive (pawing)\", \n         \"BALB/cJ passive (moving)\", \"BALB/cJ passive (not moving)\")            # legend labels\nlwd = 2                       # line width\nsexverticaloffset = 1         # vertical position of \"male\" and \"female\" x-axis labels\nageverticaloffset = 2.5       # vertical position of age x-axis labels\nxlabelcex = 1.3               # x-axis labels size\n\npng(file = \"passive not moving, subparts, pct of 61 time bins.png\", width = 640, height = 512)\t\npar(mar = c(5.1, 4.1, 4.1, 4.1))\nbarplot2af2(bars, plot.ci = FALSE, col = barcolors, space = btwnbarspace, \n            ylab = \"Portion (%) of all scored time points\", names.arg = NULL, \n            cex.names = 1.5, las = 2, yaxt = \"n\", cex.lab = 1.5, ylim = c(0, plottop))\nabline(h = 0, lwd = lwd)\naxis(1, at = c(7.2, 13.6), las = 2, lwd = lwd, labels = c(\"\",\"\"), tck = -0.1)\naxis(2, at = tkmks, las = 2, lwd = lwd, cex.axis = 1.5)\naxis(4, at = tkmks2/0.61, las = 2, lwd = lwd, cex.axis = 1.6, labels = tkmks2)\npar(xpd = T) \ntext(21.7, 20, \"Number of time points\", cex = 1.5, srt = 270)\npar(xpd = F)\npar(font = 2)\n#legend(12.7, 22, leg2, fill = leg1, cex = 1.0, bty = \"n\")\nlegend(4.5, plottop, leg2[1:5], fill = leg1[1:5], cex = 1.0, bty = \"n\")\nlegend(12.2, plottop, leg2[6:10], fill = leg1[6:10], cex = 1.0, bty = \"n\")\npar(font = 1)\ntext(4.0, labels = \"30 days\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, \n     offset = ageverticaloffset, font = 2)\ntext(10.4, labels = \"41 days\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, \n     offset = ageverticaloffset, font = 2)\ntext(16.8, labels = \"69 days\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, \n     offset = ageverticaloffset, font = 2)\ntext(c(2.6, 9.0, 15.4), labels = \"female\", par(\"usr\")[3], pos = 1, xpd = T, \n     cex = xlabelcex, offset = sexverticaloffset, font = 2)\ntext(c(5.4, 11.8, 18.2), labels = \"male\", par(\"usr\")[3], pos = 1, xpd = T, \n     cex = xlabelcex, offset = sexverticaloffset, font = 2)\ndev.off()\t\n",
    "created" : 1432526530358.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1016346435",
    "id" : "F46159CA",
    "lastKnownWriteTime" : 1432526203,
    "path" : "/media/zh/My Passport/backup/2015 code share/Fairless et al 2013 Fig 3c/to share/revising.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}